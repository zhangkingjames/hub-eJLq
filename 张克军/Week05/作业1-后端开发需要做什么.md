# 客服工作台FAQ智能匹配系统 - 开发作业文档

## 作业1：后端与算法开发角色任务分析

**文档定位**：本文档基于《FAQ类目管理》《FAQ管理》两份产品操作手册，从技术实现角度反向推导，明确后端开发与算法开发在构建该系统中承担的具体职责。

---

### 一、后端开发工程师：构建数据与业务骨架

#### 1. 数据库设计 —— **必须且核心**
产品功能要求“无限级类目”“FAQ相似问（上限200条）”“双环境（测试/正式）”，因此需要设计以下主要表结构：

| 表名                 | 关键字段                               | 设计要点                                   |
|----------------------|----------------------------------------|--------------------------------------------|
| `category`           | id, name, parent_id, level, env       | 自关联实现无限极分类，`env` 区分环境       |
| `faq`                | id, category_id, title, answer,生效时间 | 标准问与答案，状态（生效/失效）           |
| `similar_question`   | id, faq_id, question                  | 存储相似问法，每条记录为一个相似问题       |
| `publish_record`     | id, env_from, env_to, status          | 记录测试至正式环境的发布操作及数据快照     |

**设计难点**：  
- **双环境**：常规方案在表中增加 `env` 字段（如 `test` / `online`），同一逻辑数据存在两份，通过“发布”动作复制或标记数据状态。  
- **无限级分类**：通过 `parent_id` 配合递归查询或路径枚举优化性能。

#### 2. 接口与业务逻辑
- **类目管理 API**：增删改查（删除需校验有无子类目或 FAQ）。  
- **FAQ 管理 API**：支持增删改、转移类目、单个/批量失效、批量导入导出（Excel 处理）。  
- **检索 API**：基于 FAQ ID 或标题关键词的模糊搜索。  
- **发布 API**：将测试环境的数据变动同步至正式环境，需处理数据一致性。

---

### 二、算法开发工程师：赋予系统智能问答能力

#### 1. 模型选型 —— **Sentence-BERT**
产品核心场景：**用户提问 ↔ 历史FAQ标准问/相似问 的语义相似度匹配**。

- **为什么不直接用原生BERT？**  
  原生BERT做相似度需将两句话拼接输入，计算量随FAQ数量线性增长，无法支撑实时检索（百万级数据时延极高）。

- **为什么选Sentence-BERT？**  
  它将句子编码为固定长度的语义向量，离线预先计算所有FAQ的向量并存入向量数据库，在线仅需编码用户问题并计算余弦相似度，实现毫秒级召回。

#### 2. BERT的使用方式 —— **离线+在线双阶段**
- **离线阶段**  
  - 加载预训练的 Sentence-BERT 模型（如 `paraphrase-multilingual-MiniLM-L12-v2`）。  
  - 对知识库中所有标准问 + 相似问进行向量化（均值池化）。  
  - 将向量及其对应 FAQ ID 存入向量数据库（Faiss / Milvus）。

- **在线阶段**  
  - 用户问题实时向量化（**与离线完全相同的模型与预处理流程**）。  
  - 调用向量数据库的近似最近邻检索接口，获取 Top-K 相似 FAQ。  
  - 可选：对召回结果使用交互式 BERT 进行精排，提升准确率。

#### 3. 是否需要大模型？ —— **可选增强，非必须**
- **FAQ匹配场景**：Sentence-BERT 已足够，性价比最高。  
- **大模型的潜在价值**：  
  - **知识泛化**：当无匹配时，利用 LLM 结合企业文档生成答案。  
  - **相似问自动挖掘**：辅助运营人员扩充相似问法，降低人工成本。  
  - **多轮对话**：若后续升级为复杂对话系统，LLM 可提供更强上下文理解能力。

---

### 三、总结
- **后端**：负责将产品功能“翻译”为稳定的数据结构与API，尤其关注双环境数据流与无限极分类。  
- **算法**：负责将非结构化文本转化为可计算的语义向量，构建高效、准确的检索匹配链路。  
- **二者协同**：后端提供干净的 FAQ 数据，算法通过向量化赋予数据智能；共同支撑“用户提问 → 相似度匹配 → 答案返回”的完整闭环。